@model IEnumerable<EPS3.Models.Message>
@{
    ViewData["Title"] = "Messages";
}

<div class="panel panel-default">
    <div class="panel-heading">
        <h3>Messages for @ViewBag.CurrentUser.UserLogin</h3>
        <input type="hidden" id="UserRoles" name="UserRoles" value="@ViewBag.Roles" />
    </div>
    <div class="panel-body">
        <table class="table table-striped table-bordered" id="messageTable" style="width: 100%">
            <thead>
                <tr>
                    <th width="5%">
                        @Html.DisplayNameFor(model => model.MessageID)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.MessageDate)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.Subject)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.Body)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.Recipients)
                    </th>
                </tr>
            </thead>
            <tbody>
            @foreach (var msg in Model)
            {

                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => msg.MessageID)
                    </td>
                    <td>
                        @String.Format("{0:M/d/yyyy HH:mm tt}", msg.MessageDate)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => msg.Subject)
                    </td>
                    <td>
                        @Html.Raw(msg.Body)
                    </td>
                    <td>
                        @foreach (var rec in msg.Recipients)
        {
                <text>@rec.User.FullName</text><br />
}
                    </td>
                </tr>
            }
            </tbody>
        </table>
    </div>
</div>
